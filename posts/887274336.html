<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>存储芯片AT24CXX | 赵逸尘个人博客</title><meta name="keywords" content="存储芯片,EEPROM,AT24CXX"><meta name="author" content="ZhaoYichen"><meta name="copyright" content="ZhaoYichen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="收集硬件存储芯片AT24CXX相关资料">
<meta property="og:type" content="article">
<meta property="og:title" content="存储芯片AT24CXX">
<meta property="og:url" content="https://zml3589110.github.io/posts/887274336.html">
<meta property="og:site_name" content="赵逸尘个人博客">
<meta property="og:description" content="收集硬件存储芯片AT24CXX相关资料">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2024-08-13T03:37:20.000Z">
<meta property="article:modified_time" content="2024-08-13T07:39:04.850Z">
<meta property="article:author" content="ZhaoYichen">
<meta property="article:tag" content="存储芯片">
<meta property="article:tag" content="EEPROM">
<meta property="article:tag" content="AT24CXX">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/img/favicon_1.png"><link rel="canonical" href="https://zml3589110.github.io/posts/887274336"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: ZhaoYichen","link":"链接: ","source":"来源: 赵逸尘个人博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '存储芯片AT24CXX',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-13 15:39:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="赵逸尘个人博客" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">344</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">490</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">194</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fas fa-random"></i><span> Random | 随机文章</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">赵逸尘个人博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fas fa-random"></i><span> Random | 随机文章</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">存储芯片AT24CXX</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-13T03:37:20.000Z" title="发表于 2024-08-13 11:37:20">2024-08-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-13T07:39:04.850Z" title="更新于 2024-08-13 15:39:04">2024-08-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A1%AC%E4%BB%B6/">硬件</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87/">存储芯片</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/EEPROM/">EEPROM</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/AT24CXX/">AT24CXX</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>32分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="存储芯片AT24CXX"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="注意说明"><a href="#注意说明" class="headerlink" title="注意说明"></a>注意说明</h1><blockquote>
<p>网上的示例代码都基于arm等内核MCU，有些地方不适合用在低端MCU上，因为内存和堆栈的显示不允许这样使用，需要重新调整IIC通讯！这边只是参考，通讯部分还需要自己重头写！特别是 delayms（10），这个在产品中是不允许出现！整整10ms内MCU啥都不做，这容易触发卡顿或者看门狗复位！</p>
</blockquote>
<h1 id="一、应用场景？"><a href="#一、应用场景？" class="headerlink" title="一、应用场景？"></a>一、应用场景？</h1><p>有些单片机没有内部的EEPROM，或者说内部的EEPROM空间不够大，这时候，我们就想到了外挂一个EEPROM芯片，而AT24C32就是一种常用的串行EEPROM存储器，它适用于许多需要在系统掉电后保留数据的嵌入式应用场景。</p>
<h1 id="二、AT24C32是什么？"><a href="#二、AT24C32是什么？" class="headerlink" title="二、AT24C32是什么？"></a>二、AT24C32是什么？</h1><p>AT24C32是一种常见的串行 EEPROM 存储器芯片，通常用于存储系统配置、用户数据、校准参数等。它具有以下特点，一般会在以下情况下被使用：</p>
<ol>
<li>小容量数据存储：AT24C32的存储容量一般为32Kb，适合存储少量的配置信息、校准参数、设备标识等数据。</li>
<li>串行接口：AT24C32采用串行接口进行数据通信，这使得它在占用较少引脚的同时能够进行高效的数据读写操作，因此适合于资源受限的嵌入式系统或小型设备中使用。</li>
<li>数据保存与恢复：AT24C32通常被用于存储需要持久保存的数据，例如设备配置、校准参数等。它的非易失性存储特性意味着即使断电也能保持数据完整，可在下次上电时恢复。</li>
<li>嵌入式系统：由于其小巧的封装、低功耗和易于集成的特点，AT24C32常被嵌入式系统设计中用于管理系统配置、日志记录、用户个性化设置等数据。</li>
</ol>
<h2 id="芯片对比"><a href="#芯片对比" class="headerlink" title="芯片对比"></a>芯片对比</h2><table>
<thead>
<tr>
<th>型号</th>
<th>容量bit</th>
<th>容量byte</th>
<th>页数</th>
<th>字节&#x2F;页</th>
<th>器件寻址位</th>
<th>可寻址器件数</th>
<th>WordAddress位数&#x2F;字节数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>AT24C32</td>
<td>32k</td>
<td>4k</td>
<td>128</td>
<td>32</td>
<td>A2A1A0</td>
<td>8</td>
<td>12&#x2F;2</td>
<td></td>
</tr>
<tr>
<td>AT24C64</td>
<td>64k</td>
<td>8k</td>
<td>256</td>
<td>32</td>
<td>A2A1A0</td>
<td>8</td>
<td>13&#x2F;2</td>
<td></td>
</tr>
<tr>
<td>AT24C128</td>
<td>128k</td>
<td>16k</td>
<td>256</td>
<td>64</td>
<td>A1A0</td>
<td>4</td>
<td>14&#x2F;2</td>
<td></td>
</tr>
<tr>
<td>AT24C256</td>
<td>256k</td>
<td>32k</td>
<td>512</td>
<td>64</td>
<td>A1A0</td>
<td>4</td>
<td>15&#x2F;2</td>
<td></td>
</tr>
<tr>
<td>T24C512</td>
<td>512k</td>
<td>64k</td>
<td>512</td>
<td>128</td>
<td>A2A1A0</td>
<td>8</td>
<td>16&#x2F;2</td>
<td></td>
</tr>
</tbody></table>
<p>这5款芯片与x24C01~x24C16主要的不同是，WordAddress是两个字节，器件寻址位A2&#x2F;A1&#x2F;A0三位或者两位，不再有页选择位。例如，下图是AT24C128、AT24C256的引脚图，只有两个硬件地址引脚A0&#x2F;A1，第3脚不连接。</p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/20c82deb985d3cf5951913aaa899dac5.jpeg" alt="在这里插入图片描述"></p>
<h1 id="三、使用步骤"><a href="#三、使用步骤" class="headerlink" title="三、使用步骤"></a>三、使用步骤</h1><h2 id="1-引脚说明"><a href="#1-引脚说明" class="headerlink" title="1.引脚说明"></a>1.引脚说明</h2><p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/38214a7931811d8a548d27d34a74da8a.png" alt="在这里插入图片描述"></p>
<p>1-3.A0~A2：地址输入引脚，共3个，用于设定芯片的I2C地址。<br>4.GND：地引脚，与VCC联合供电。<br>5.SDA：串行数据输入&#x2F;输出引脚，用于与I2C总线进行通信。<br>6.SCL：串行时钟输入引脚，用于与I2C总线进行同步。<br>7.WP：写保护引脚，当WP引脚为高电平时，AT24C32将无法写入数据，起到了对AT24C32数据的保护作用。<br>8.VCC：供电引脚，连接正极电源。</p>
<p>其中，WP引脚是AT24C32的写保护引脚，用于控制AT24C32是否可以写入数据。当WP引脚处于高电平时，AT24C32将进入写保护模式，此时将无法写入数据。当WP引脚处于低电平时，AT24C32将退出写保护模式，此时可以向其写入数据。通常情况下，WP引脚需要连接到系统中的GPIO引脚上，以便在需要时能够动态控制AT24C32的写保护模式</p>
<h2 id="1-2读写操作"><a href="#1-2读写操作" class="headerlink" title="1.2读写操作"></a>1.2读写操作</h2><h3 id="1-2-1-写操作"><a href="#1-2-1-写操作" class="headerlink" title="1.2.1 写操作"></a>1.2.1 写操作</h3><blockquote>
<p>Byte Write写一个字节</p>
</blockquote>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/fa32d91c43f56a9dd68230bcbc58e5be.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/333d97e0a12acba951ce5386822c7fa1.jpeg" alt="在这里插入图片描述"></p>
<p>AT24C32和AT24C64手册中写单个字节的操作及时序，红框中可以看出，在器件地址、应答信号后，跟着的是两个字节的WordAddress，这就是与AT24C01~AT24C16芯片的主要区别。</p>
<blockquote>
<p>Page Write写一页</p>
</blockquote>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/5af729615f1ccd745490d5189268c84c.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/9cb2f1b365cefa35d8166481fb89dd37.jpeg" alt="在这里插入图片描述"></p>
<p>页写操作也是没有多少新东西，除了WordAddress有两个字节，与其他容量芯片的操作类似。</p>
<h3 id="1-2-2-写操作"><a href="#1-2-2-写操作" class="headerlink" title="1.2.2 写操作"></a>1.2.2 写操作</h3><blockquote>
<p>读任意地址</p>
</blockquote>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/0a65056c7e0035e21f9a6478d5ad7e00.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/8fd2fe0e7d01d7646c7ed65edef533c5.jpeg" alt="在这里插入图片描述"></p>
<p>与较小容量的芯片相比，读任意地址的时序，主要的区别是需要发送两个字节的WordAddress。</p>
<blockquote>
<p>顺序读（页读）</p>
</blockquote>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/dac42b01a38b994fb7e1b363a9a05629.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/afc4a8430e152ce2d646ec5529db96da.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/16372561c08ea950ca362cd5ca8772bb.jpeg" alt="在这里插入图片描述"></p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/95e1f8167e340a33cd5426855e4548bf.jpeg" alt="在这里插入图片描述"></p>
<p>以上为页读操作，也是由“读当前地址”或“读任意地址”操作开始，mcu收到一个数据后，应答，不发送停止信号，即可接收下一个字节数据。</p>
<h3 id="1-2-3-示例代码-可参考"><a href="#1-2-3-示例代码-可参考" class="headerlink" title="1.2.3 示例代码(可参考)"></a>1.2.3 示例代码(可参考)</h3><blockquote>
<p><strong>宏定义</strong><br>先对器件地址等信息进行宏定义，根据不同的器件进行条件编译：</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_CMD				1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WRITE_CMD				0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> x24C32<span class="comment">//器件名称，AT24C32、AT24C64、AT24C128、AT24C256、AT24C512</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEV_ADDR				0xA0					<span class="comment">//设备硬件地址</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> x24C32</span></span><br><span class="line"> 	<span class="meta">#<span class="meta-keyword">define</span> PAGE_NUM			128						<span class="comment">//页数</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE			32						<span class="comment">//页面大小(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> CAPACITY_SIZE		(PAGE_NUM * PAGE_SIZE)	<span class="comment">//总容量(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ADDR_BYTE_NUM		2						<span class="comment">//地址字节个数</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> x24C64</span></span><br><span class="line"> 	<span class="meta">#<span class="meta-keyword">define</span> PAGE_NUM			256						<span class="comment">//页数</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE			32						<span class="comment">//页面大小(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> CAPACITY_SIZE		(PAGE_NUM * PAGE_SIZE)	<span class="comment">//总容量(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ADDR_BYTE_NUM		2						<span class="comment">//地址字节个数</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> x24C128</span></span><br><span class="line"> 	<span class="meta">#<span class="meta-keyword">define</span> PAGE_NUM			256						<span class="comment">//页数</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE			64						<span class="comment">//页面大小(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> CAPACITY_SIZE		(PAGE_NUM * PAGE_SIZE)	<span class="comment">//总容量(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ADDR_BYTE_NUM		2						<span class="comment">//地址字节个数</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> x24C256</span></span><br><span class="line"> 	<span class="meta">#<span class="meta-keyword">define</span> PAGE_NUM			512						<span class="comment">//页数</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE			64						<span class="comment">//页面大小(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> CAPACITY_SIZE		(PAGE_NUM * PAGE_SIZE)	<span class="comment">//总容量(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ADDR_BYTE_NUM		2						<span class="comment">//地址字节个数</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> x24C512</span></span><br><span class="line"> 	<span class="meta">#<span class="meta-keyword">define</span> PAGE_NUM			512						<span class="comment">//页数</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE			128						<span class="comment">//页面大小(字节) </span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> CAPACITY_SIZE		(PAGE_NUM * PAGE_SIZE)	<span class="comment">//总容量(字节)</span></span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> ADDR_BYTE_NUM		2						<span class="comment">//地址字节个数</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>写单个字节（写任意地址）</strong><br>发送起始信号–&gt;发送器件地址（包含写入命令）–&gt;收到应答–&gt;发送需要写入数据的地址的高字节（8bit）–&gt;收到应答–&gt;发送需要写入数据的地址的低字节（8bit）–&gt;收到应答–&gt;发送需要写入的数据–&gt;收到应答–&gt;发送停止信号</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">  * 函数名：x24Cxx_WriteByte</span></span><br><span class="line"><span class="comment">  * 功  能：写一个字节</span></span><br><span class="line"><span class="comment">  * 参  数：u16Addr要写入的地址</span></span><br><span class="line"><span class="comment">			u8Data要写入的数据</span></span><br><span class="line"><span class="comment">  * 返回值：无</span></span><br><span class="line"><span class="comment">  * 说  明：无</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x24Cxx_WriteByte</span><span class="params">(<span class="keyword">uint16_t</span> u16Addr, <span class="keyword">uint8_t</span> u8Data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	x24Cxx_WriteEnable();<span class="comment">//使能写入</span></span><br><span class="line">	IIC_Start();<span class="comment">//起始信号</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | WRITE_CMD);<span class="comment">//器件寻址+读/写选择</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)((u16Addr &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)(u16Addr &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte(u8Data);</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_Stop();<span class="comment">//停止信号</span></span><br><span class="line">	x24Cxx_WriteDisble();<span class="comment">//禁止写入</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>写一页</strong><br>发送起始信号–&gt;发送器件地址（包含写入命令）–&gt;收到应答–&gt;发送需要写入数据的首地址的高字节（8bit）–&gt;收到应答–&gt;发送需要写入数据的首地址的低字节（8bit）–&gt;收到应答–&gt;发送需要写入的第1个数据–&gt;收到应答–&gt;发送需要写入的第2个数据–&gt;收到应答…–&gt;发送需要写入的第n个数据–&gt;收到应答–&gt;发送停止信号</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">  * 函数名：x24Cxx_WritePage</span></span><br><span class="line"><span class="comment">  * 功  能：页写</span></span><br><span class="line"><span class="comment">  * 参  数：u16Addr要写入的首地址；</span></span><br><span class="line"><span class="comment">			u8Len写入数据字节数，最大为PAGE_SIZE</span></span><br><span class="line"><span class="comment">			pData要写入的数据首地址</span></span><br><span class="line"><span class="comment">  * 返回值：无</span></span><br><span class="line"><span class="comment">  * 说  明：最多写入1页，防止翻卷，如果地址跨页则去掉跨页的部分</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x24Cxx_WritePage</span><span class="params">(<span class="keyword">uint16_t</span> u16Addr, <span class="keyword">uint8_t</span> u8Len, <span class="keyword">uint8_t</span> *pData)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint8_t</span> i;</span><br><span class="line">	x24Cxx_WriteEnable();<span class="comment">//使能写入</span></span><br><span class="line">	IIC_Start();<span class="comment">//起始信号</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | WRITE_CMD);<span class="comment">//器件寻址+读/写选择</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)((u16Addr &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)(u16Addr &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	<span class="keyword">if</span> (u8Len &gt; PAGE_SIZE)<span class="comment">//长度大于页的长度</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len = PAGE_SIZE;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ((u16Addr + (<span class="keyword">uint16_t</span>)u8Len) &gt; CAPACITY_SIZE)<span class="comment">//超过容量</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len = (<span class="keyword">uint8_t</span>)(CAPACITY_SIZE - u16Addr);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (((u16Addr % PAGE_SIZE) + (<span class="keyword">uint16_t</span>)u8Len) &gt; PAGE_SIZE)<span class="comment">//判断是否跨页</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len -= (<span class="keyword">uint8_t</span>)((u16Addr + (<span class="keyword">uint16_t</span>)u8Len) % PAGE_SIZE);<span class="comment">//跨页，截掉跨页的部分</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; u8Len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		IIC_WriteByte(*(pData + i));</span><br><span class="line">		IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	&#125;</span><br><span class="line">	IIC_Stop();<span class="comment">//停止信号	</span></span><br><span class="line">	x24Cxx_WriteDisble();<span class="comment">//禁止写入</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>读单个字节（读任意地址）</strong><br>发送起始信号–&gt;发送器件地址（包含写入命令）–&gt;收到应答–&gt;发送需要读取数据的地址的高字节（8bit）–&gt;收到应答–&gt;发送需要读取数据的地址的低字节（8bit）–&gt;收到应答–&gt;发送起始信号–&gt;发送器件地址（包含读取命令）–&gt;收到应答–&gt;读取数据–&gt;不应答–&gt;发送停止信号</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">  * 函数名：x24Cxx_ReadByte</span></span><br><span class="line"><span class="comment">  * 功  能：读一个字节</span></span><br><span class="line"><span class="comment">  * 参  数：u16Addr要读取的地址</span></span><br><span class="line"><span class="comment">  * 返回值：u8Data读出的数据</span></span><br><span class="line"><span class="comment">  * 说  明：无</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">x24Cxx_ReadByte</span><span class="params">(<span class="keyword">uint16_t</span> u16Addr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint8_t</span> u8Data = <span class="number">0</span>;</span><br><span class="line">	IIC_Start();<span class="comment">//起始信号	</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | WRITE_CMD);<span class="comment">//器件寻址+读/写选择</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)((u16Addr &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)(u16Addr &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_Start();<span class="comment">//起始信号</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | READ_CMD);<span class="comment">//器件寻址+读</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	u8Data = IIC_ReadByte();</span><br><span class="line">	IIC_NoAck();</span><br><span class="line">	IIC_Stop();<span class="comment">//停止信号</span></span><br><span class="line">	<span class="keyword">return</span> u8Data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>读一页（顺序读）</strong><br>发送起始信号–&gt;发送器件地址（包含写入命令）–&gt;收到应答–&gt;发送需要读取数据的首地址高字节–&gt;收到应答–&gt;发送需要读取数据的首地址低字节–&gt;收到应答–&gt;发送起始信号–&gt;发送器件地址（包含读取命令）–&gt;收到应答–&gt;读取第1个数据–&gt;发送应答–&gt;读取第2个数据–&gt;发送应答…–&gt;读取第n个数据–&gt;不应答–&gt;发送停止信号</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">  * 函数名：x24Cxx_ReadPage</span></span><br><span class="line"><span class="comment">  * 功  能：页读</span></span><br><span class="line"><span class="comment">  * 参  数：u16Addr要读取的首地址；</span></span><br><span class="line"><span class="comment">			u8Len读取数据字节数，最大为PAGE_SIZE</span></span><br><span class="line"><span class="comment">			pBuff读取数据存入的缓存</span></span><br><span class="line"><span class="comment">  * 返回值：无</span></span><br><span class="line"><span class="comment">  * 说  明：最多读1页，防止翻卷，如果地址跨页则去掉跨页的部分</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x24Cxx_ReadPage</span><span class="params">(<span class="keyword">uint16_t</span> u16Addr, <span class="keyword">uint8_t</span> u8Len, <span class="keyword">uint8_t</span> *pBuff)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint8_t</span> i;	</span><br><span class="line">	IIC_Start();<span class="comment">//起始信号	</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | WRITE_CMD);<span class="comment">//器件寻址+读/写选择</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)((u16Addr &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_WriteByte((<span class="keyword">uint8_t</span>)(u16Addr &amp; <span class="number">0xFF</span>));</span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	IIC_Start();<span class="comment">//起始信号</span></span><br><span class="line">	IIC_WriteByte(DEV_ADDR | READ_CMD);<span class="comment">//器件寻址+读</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待应答</span></span><br><span class="line">	<span class="keyword">if</span> (u8Len &gt; PAGE_SIZE)<span class="comment">//长度大于页的长度</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len = PAGE_SIZE;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ((u16Addr + (<span class="keyword">uint16_t</span>)u8Len) &gt; CAPACITY_SIZE)<span class="comment">//超过容量</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len = (<span class="keyword">uint8_t</span>)(CAPACITY_SIZE - u16Addr);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (((u16Addr % PAGE_SIZE) + (<span class="keyword">uint16_t</span>)u8Len) &gt; PAGE_SIZE)<span class="comment">//判断是否跨页</span></span><br><span class="line">	&#123;</span><br><span class="line">		u8Len -= (<span class="keyword">uint8_t</span>)((u16Addr + (<span class="keyword">uint16_t</span>)u8Len) % PAGE_SIZE);<span class="comment">//跨页，截掉跨页的部分</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; (u8Len - <span class="number">1</span>); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		*(pBuff + i) = IIC_ReadByte();</span><br><span class="line">		IIC_Ack();<span class="comment">//主机应答</span></span><br><span class="line">	&#125;</span><br><span class="line">	*(pBuff + u8Len - <span class="number">1</span>) = IIC_ReadByte();</span><br><span class="line">	IIC_NoAck();<span class="comment">//最后一个不应答</span></span><br><span class="line">	IIC_Stop();<span class="comment">//停止信号</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意事项</strong></p>
</blockquote>
<ol>
<li>仅适用于x24C32、x24C64、x24C128、x24C256、x24C512系列EEPROM芯片，其他容量芯片请参考第一节中链接的相关文章；</li>
<li>器件地址必须与A2&#x2F;A1&#x2F;A0引脚的硬件连接对应；</li>
<li>调用写入程序（无论是单字节写入还是页写），需要延时10ms（即twr,有的芯片手册说是5ms）后再对器件进行操作，否则这段时间内器件不响应命令；</li>
</ol>
<h2 id="2-示例代码"><a href="#2-示例代码" class="headerlink" title="2.示例代码"></a>2.示例代码</h2><p>EEPROM设备都需要一个8位设备地址字，包含一个启动条件，以使芯片能够进行读或写操作。设备地址字前4位最高有效位为1010。这对所有串行EEPROM设备都是通用的。接下来的3位是EEPROM的A2、A1和A0设备地址位。设备地址的第8位是读写操作选择位。如果该位高，则进行读操作；如果该位低，则进行写操作。</p>
<p>综上，如果对AT24C32进行读操作，则设备地址为10100001B&#x3D;A1H；如果对AT24C32进行写操作，则设备地址为10100000B&#x3D;A0H.</p>
<h3 id="2-1-读取一个字节数据代码如下（示例）："><a href="#2-1-读取一个字节数据代码如下（示例）：" class="headerlink" title="2.1 读取一个字节数据代码如下（示例）："></a>2.1 读取一个字节数据代码如下（示例）：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment"> * 函数名：AT24CXX_ReadOneByte</span></span><br><span class="line"><span class="comment"> * 描述  ：从串行EEPROM指定地址处开始读取一个字节数据</span></span><br><span class="line"><span class="comment"> * 输入  ：_usAddress地址</span></span><br><span class="line"><span class="comment"> * 输出  ：读取的数据dat</span></span><br><span class="line"><span class="comment"> * 调用  ：</span></span><br><span class="line"><span class="comment"> * 备注  ：</span></span><br><span class="line"><span class="comment"> *******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">AT24CXX_ReadOneByte</span><span class="params">(<span class="keyword">uint16_t</span> _usAddress)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint8_t</span> dat = <span class="number">0</span>;		  	    																 </span><br><span class="line">	EE_IIC_Start();  </span><br><span class="line">	<span class="keyword">if</span>(EE_SIZE &gt; ((<span class="number">128</span>*<span class="number">16</span>)))<span class="comment">//&gt;AT24C16</span></span><br><span class="line">	&#123;</span><br><span class="line">		EE_IIC_Send_Byte(EE_DEV_ADDR);<span class="comment">//发送写命令</span></span><br><span class="line">		EE_IIC_Wait_Ack();</span><br><span class="line">		EE_IIC_Send_Byte(_usAddress&gt;&gt;<span class="number">8</span>);<span class="comment">//发送高地址 </span></span><br><span class="line">		EE_IIC_Wait_Ack(); </span><br><span class="line">	&#125;		</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		EE_IIC_Send_Byte(EE_DEV_ADDR + ((_usAddress/<span class="number">256</span>)&lt;&lt;<span class="number">1</span>));<span class="comment">//发送器件地址0xA0,写数据		  </span></span><br><span class="line">	&#125;			</span><br><span class="line">	EE_IIC_Send_Byte(_usAddress%<span class="number">256</span>);<span class="comment">//发送低地址</span></span><br><span class="line">	EE_IIC_Wait_Ack();	    </span><br><span class="line">	EE_IIC_Start();  	 	   </span><br><span class="line">	EE_IIC_Send_Byte(EE_DEV_ADDR | I2C_RD);<span class="comment">//进入接收模式0xA1			   </span></span><br><span class="line">	EE_IIC_Wait_Ack();	 </span><br><span class="line">	dat = EE_IIC_Read_Byte(<span class="number">0</span>);		   </span><br><span class="line">	EE_IIC_Stop();<span class="comment">//产生一个停止条件	    </span></span><br><span class="line">	<span class="keyword">return</span> dat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-2-写入一个字节数据代码如下（示例）："><a href="#2-2-写入一个字节数据代码如下（示例）：" class="headerlink" title="2.2 写入一个字节数据代码如下（示例）："></a>2.2 写入一个字节数据代码如下（示例）：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment"> * 函数名：AT24CXX_WriteOneByte</span></span><br><span class="line"><span class="comment"> * 描述  ：从串行EEPROM指定地址处开始写入一个字节数据</span></span><br><span class="line"><span class="comment"> * 输入  ：_usAddress地址,_usWrite数据</span></span><br><span class="line"><span class="comment"> * 输出  ：void</span></span><br><span class="line"><span class="comment"> * 调用  ：</span></span><br><span class="line"><span class="comment"> * 备注  ：</span></span><br><span class="line"><span class="comment"> *******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteOneByte</span><span class="params">(<span class="keyword">uint16_t</span> _usAddress,<span class="keyword">uint8_t</span> _usWrite)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	EE_IIC_Start();</span><br><span class="line">	<span class="keyword">if</span>(EE_SIZE &gt; ((<span class="number">128</span>*<span class="number">16</span>)))<span class="comment">//&gt;AT24C16</span></span><br><span class="line">    &#123;  </span><br><span class="line">	    EE_IIC_Send_Byte(EE_DEV_ADDR);<span class="comment">//发送写命令</span></span><br><span class="line">		EE_IIC_Wait_Ack();</span><br><span class="line">		EE_IIC_Send_Byte(_usAddress&gt;&gt;<span class="number">8</span>);<span class="comment">//发送高地址</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		EE_IIC_Send_Byte(EE_DEV_ADDR + ((_usAddress/<span class="number">256</span>)&lt;&lt;<span class="number">1</span>));<span class="comment">//发送器件地址0xA0,写数据		  			</span></span><br><span class="line">	&#125;</span><br><span class="line">	EE_IIC_Wait_Ack();	   </span><br><span class="line">	EE_IIC_Send_Byte(_usAddress%<span class="number">256</span>);<span class="comment">//发送低地址</span></span><br><span class="line">	EE_IIC_Wait_Ack(); 	 										  		   </span><br><span class="line">	EE_IIC_Send_Byte(_usWrite);<span class="comment">//发送字节							   </span></span><br><span class="line">	EE_IIC_Wait_Ack();  		    	   </span><br><span class="line">	EE_IIC_Stop();<span class="comment">//产生一个停止条件 </span></span><br><span class="line">	delay_syms(<span class="number">10</span>);	 </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-3-读取若干数据代码如下（示例）："><a href="#2-3-读取若干数据代码如下（示例）：" class="headerlink" title="2.3 读取若干数据代码如下（示例）："></a>2.3 读取若干数据代码如下（示例）：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment"> * 函数名：AT24CXX_ReadBytes</span></span><br><span class="line"><span class="comment"> * 描述  ：从串行EEPROM指定地址处开始读取若干数据</span></span><br><span class="line"><span class="comment"> * 输入  ： usAddress : 起始地址</span></span><br><span class="line"><span class="comment"> *			_pReadBuf : 存放读到的数据的缓冲区指针</span></span><br><span class="line"><span class="comment"> *			 _usSize : 数据长度，单位为字节</span></span><br><span class="line"><span class="comment"> * 输出  ：0 表示失败，1表示成功</span></span><br><span class="line"><span class="comment"> * 调用  ：</span></span><br><span class="line"><span class="comment"> * 备注  ：</span></span><br><span class="line"><span class="comment"> *******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_ReadBytes</span><span class="params">(<span class="keyword">uint16_t</span> _usAddress, <span class="keyword">uint8_t</span> *_pReadBuf, <span class="keyword">uint16_t</span> _usSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(_usSize)</span><br><span class="line">	&#123;</span><br><span class="line">		    *_pReadBuf++ = AT24CXX_ReadOneByte(_usAddress++);</span><br><span class="line">			 _usSize--; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-4-写入若干数据代码如下（示例）："><a href="#2-4-写入若干数据代码如下（示例）：" class="headerlink" title="2.4 写入若干数据代码如下（示例）："></a>2.4 写入若干数据代码如下（示例）：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment"> * 函数名：AT24CXX_WriteBytes</span></span><br><span class="line"><span class="comment"> * 描述  ：向串行EEPROM指定地址写入若干数据</span></span><br><span class="line"><span class="comment"> * 输入  ：_usAddress : 起始地址 </span></span><br><span class="line"><span class="comment"> *			 _pWriteBuf : 存放读到的数据的缓冲区指针</span></span><br><span class="line"><span class="comment"> *			 _usSize : 数据长度，单位为字节</span></span><br><span class="line"><span class="comment"> * 调用  ：0 表示失败，1表示成功</span></span><br><span class="line"><span class="comment"> * 备注  ：</span></span><br><span class="line"><span class="comment"> *******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteBytes</span><span class="params">(<span class="keyword">uint16_t</span> _usAddress, <span class="keyword">uint8_t</span> *_pWriteBuf, <span class="keyword">uint16_t</span> _usSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(_usSize--)</span><br><span class="line">	&#123;</span><br><span class="line">		AT24CXX_WriteOneByte(_usAddress,*_pWriteBuf);</span><br><span class="line">        _usAddress++;</span><br><span class="line">		_pWriteBuf++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-5-测试代码如下（示例）："><a href="#2-5-测试代码如下（示例）：" class="headerlink" title="2.5 测试代码如下（示例）："></a>2.5 测试代码如下（示例）：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment"> * 函数名：DEBUG_test_AT24C32</span></span><br><span class="line"><span class="comment"> * 描述  ：测试AT24C32</span></span><br><span class="line"><span class="comment"> * 输入  ：void</span></span><br><span class="line"><span class="comment"> * 输出  ：void</span></span><br><span class="line"><span class="comment"> * 调用  ：</span></span><br><span class="line"><span class="comment"> * 备注  ：</span></span><br><span class="line"><span class="comment"> *******************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DEBUG_test_AT24C32</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint8_t</span> i,j;</span><br><span class="line">	<span class="keyword">if</span>(EE_CheckOk() == <span class="number">1</span>)<span class="comment">//检测设备是否存在</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Check OK \r\n&quot;</span>);</span><br><span class="line">		 </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	    &#123;</span><br><span class="line">		    test_buf1[i] = i;</span><br><span class="line">	    &#125;	</span><br><span class="line">	    AT24CXX_WriteBytes(<span class="number">0x20</span>,test_buf1,<span class="number">16</span>);</span><br><span class="line">	 </span><br><span class="line">	    AT24CXX_ReadBytes(<span class="number">0x20</span>,test_buf2,<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j++)</span><br><span class="line">	    &#123;</span><br><span class="line">		    <span class="built_in">printf</span>(<span class="string">&quot;test_buf2 = %d\r\n&quot;</span>,test_buf2[j]);</span><br><span class="line">	    &#125;			 </span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		 <span class="built_in">printf</span>(<span class="string">&quot;Check Fail \r\n&quot;</span>);</span><br><span class="line">	&#125;	 </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-测试结果"><a href="#3-测试结果" class="headerlink" title="3.测试结果"></a>3.测试结果</h2><p>和测试代码写的结果是一样，测试代码首先把0-15写入到test_buf1数组里面，再通过写函数把它写入到EEPROM芯片，最后通过读函数将它读取出来给到test_buf2数组，再打印出来。</p>
<p><img src="/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87AT24CXX/73927b5bda1c6cb8ad9fae358b9a2452.png" alt="在这里插入图片描述"></p>
<h1 id="其他示例代码一"><a href="#其他示例代码一" class="headerlink" title="其他示例代码一"></a>其他示例代码一</h1><h2 id="IIC-H"><a href="#IIC-H" class="headerlink" title="IIC.H"></a>IIC.H</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __IIC_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IIC_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;sys.h&quot;</span></span></span><br><span class="line"><span class="comment">//	 </span></span><br><span class="line"><span class="comment">//本程序只供学习使用，未经作者许可，不得用于其它任何用途</span></span><br><span class="line"><span class="comment">//Mini STM32开发板</span></span><br><span class="line"><span class="comment">//IIC 驱动函数	   </span></span><br><span class="line"><span class="comment">//正点原子@ALIENTEK</span></span><br><span class="line"><span class="comment">//技术论坛:www.openedv.com</span></span><br><span class="line"><span class="comment">//修改日期:2010/6/10 </span></span><br><span class="line"><span class="comment">//版本：V1.0</span></span><br><span class="line"><span class="comment">//版权所有，盗版必究。</span></span><br><span class="line"><span class="comment">//Copyright(C) 正点原子 2009-2019</span></span><br><span class="line"><span class="comment">//All rights reserved</span></span><br><span class="line"><span class="comment">// 	  </span></span><br><span class="line"> </span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">//IO方向设置</span></span><br><span class="line"><span class="comment">#define SDA_IN()  &#123;GPIOC-&gt;CRH&amp;=0XFFFF0FFF;GPIOC-&gt;CRH|=8&lt;&lt;12;&#125;</span></span><br><span class="line"><span class="comment">#define SDA_OUT() &#123;GPIOC-&gt;CRH&amp;=0XFFFF0FFF;GPIOC-&gt;CRH|=3&lt;&lt;12;&#125;</span></span><br><span class="line"><span class="comment">//IO操作函数	 </span></span><br><span class="line"><span class="comment">#define IIC_SCL    PCout(12) //SCL</span></span><br><span class="line"><span class="comment">#define IIC_SDA    PCout(11) //SDA	 </span></span><br><span class="line"><span class="comment">#define READ_SDA   PCin(11)  //输入SDA </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//IO方向设置</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDA_IN()  &#123;GPIOA-&gt;CRL&amp;=0X0FFFFFFF;GPIOA-&gt;CRL|=8&lt;&lt;28;&#125;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDA_OUT() &#123;GPIOA-&gt;CRL&amp;=0X0FFFFFFF;GPIOA-&gt;CRL|=3&lt;&lt;28;&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//IO操作函数	 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL    PAout(6) <span class="comment">//SCL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA    PAout(7) <span class="comment">//SDA	 </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_SDA   PAin(7)  <span class="comment">//输入SDA </span></span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//IIC所有操作函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Init</span><span class="params">(<span class="keyword">void</span>)</span></span>;                <span class="comment">//初始化IIC的IO口				 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Start</span><span class="params">(<span class="keyword">void</span>)</span></span>;				<span class="comment">//发送IIC开始信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Stop</span><span class="params">(<span class="keyword">void</span>)</span></span>;	  			<span class="comment">//发送IIC停止信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Send_Byte</span><span class="params">(u8 txd)</span></span>;			<span class="comment">//IIC发送一个字节</span></span><br><span class="line"><span class="function">u8 <span class="title">IIC_Read_Byte</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> ack)</span></span>;<span class="comment">//IIC读取一个字节</span></span><br><span class="line"><span class="function">u8 <span class="title">IIC_Wait_Ack</span><span class="params">(<span class="keyword">void</span>)</span></span>; 				<span class="comment">//IIC等待ACK信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Ack</span><span class="params">(<span class="keyword">void</span>)</span></span>;					<span class="comment">//IIC发送ACK信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_NAck</span><span class="params">(<span class="keyword">void</span>)</span></span>;				<span class="comment">//IIC不发送ACK信号</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Write_One_Byte</span><span class="params">(u8 daddr,u8 addr,u8 data)</span></span>;</span><br><span class="line"><span class="function">u8 <span class="title">IIC_Read_One_Byte</span><span class="params">(u8 daddr,u8 addr)</span></span>;	  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h2 id="IIC-C"><a href="#IIC-C" class="headerlink" title="IIC.C"></a>IIC.C</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;iic.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;delay.h&quot;</span></span></span><br><span class="line"><span class="comment">//	 </span></span><br><span class="line"><span class="comment">//本程序只供学习使用，未经作者许可，不得用于其它任何用途</span></span><br><span class="line"><span class="comment">//Mini STM32开发板</span></span><br><span class="line"><span class="comment">//IIC 驱动函数	   </span></span><br><span class="line"><span class="comment">//正点原子@ALIENTEK</span></span><br><span class="line"><span class="comment">//技术论坛:www.openedv.com</span></span><br><span class="line"><span class="comment">//修改日期:2010/6/10 </span></span><br><span class="line"><span class="comment">//版本：V1.0</span></span><br><span class="line"><span class="comment">//版权所有，盗版必究。</span></span><br><span class="line"><span class="comment">//Copyright(C) 正点原子 2009-2019</span></span><br><span class="line"><span class="comment">//All rights reserved</span></span><br><span class="line"><span class="comment">// 	  </span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">//初始化IIC</span></span><br><span class="line"><span class="comment">void IIC_Init(void)</span></span><br><span class="line"><span class="comment">&#123;					     </span></span><br><span class="line"><span class="comment">	GPIO_InitTypeDef GPIO_InitStructure;</span></span><br><span class="line"><span class="comment">	//RCC-&gt;APB2ENR|=1&lt;&lt;4;//先使能外设IO PORTC时钟 </span></span><br><span class="line"><span class="comment">	RCC_APB2PeriphClockCmd(	RCC_APB2Periph_GPIOC, ENABLE );	</span></span><br><span class="line"><span class="comment">	   </span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;</span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP ;   //推挽输出</span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span></span><br><span class="line"><span class="comment">	GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;</span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP ;   //推挽输出</span></span><br><span class="line"><span class="comment">	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span></span><br><span class="line"><span class="comment">	GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">	IIC_SCL=1;</span></span><br><span class="line"><span class="comment">	IIC_SDA=1;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;					     </span><br><span class="line">		GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class="line">		RCC_APB2PeriphClockCmd(	RCC_APB2Periph_GPIOA, ENABLE );</span><br><span class="line">		</span><br><span class="line">		GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;	<span class="comment">//PA6  SCL</span></span><br><span class="line">		GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP ;   <span class="comment">//推挽输出</span></span><br><span class="line">		GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">		GPIO_Init(GPIOA, &amp;GPIO_InitStructure);</span><br><span class="line">	</span><br><span class="line">		GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7;	<span class="comment">//PA7  SDA</span></span><br><span class="line">		GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP ;   <span class="comment">//推挽输出</span></span><br><span class="line">		GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class="line">		GPIO_Init(GPIOA, &amp;GPIO_InitStructure);</span><br><span class="line">		</span><br><span class="line">		IIC_SCL=<span class="number">1</span>;</span><br><span class="line">		IIC_SDA=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//产生IIC起始信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Start</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		SDA_OUT();     <span class="comment">//sda线输出</span></span><br><span class="line">		IIC_SDA=<span class="number">1</span>;	  	  </span><br><span class="line">		IIC_SCL=<span class="number">1</span>;</span><br><span class="line">		delay_us(<span class="number">4</span>);</span><br><span class="line">		IIC_SDA=<span class="number">0</span>;<span class="comment">//START:when CLK is high,DATA change form high to low </span></span><br><span class="line">		delay_us(<span class="number">4</span>);</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;<span class="comment">//钳住I2C总线，准备发送或接收数据 </span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//产生IIC停止信号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Stop</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		SDA_OUT();<span class="comment">//sda线输出</span></span><br><span class="line">		IIC_SCL=<span class="number">0</span>;</span><br><span class="line">		IIC_SDA=<span class="number">0</span>;<span class="comment">//STOP:when CLK is high DATA change form low to high</span></span><br><span class="line">		delay_us(<span class="number">4</span>);</span><br><span class="line">		IIC_SCL=<span class="number">1</span>; </span><br><span class="line">		delay_us(<span class="number">4</span>);</span><br><span class="line">		IIC_SDA=<span class="number">1</span>;<span class="comment">//发送I2C总线结束信号</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//等待应答信号到来</span></span><br><span class="line"><span class="comment">//返回值：1，接收应答失败</span></span><br><span class="line"><span class="comment">//        0，接收应答成功</span></span><br><span class="line"><span class="function">u8 <span class="title">IIC_Wait_Ack</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 ucErrTime=<span class="number">0</span>;</span><br><span class="line">		SDA_IN();      <span class="comment">//SDA设置为输入  </span></span><br><span class="line">		IIC_SDA=<span class="number">1</span>;delay_us(<span class="number">1</span>);	   </span><br><span class="line">		IIC_SCL=<span class="number">1</span>;delay_us(<span class="number">1</span>);	 </span><br><span class="line">		<span class="keyword">while</span>(READ_SDA)</span><br><span class="line">		&#123;</span><br><span class="line">				ucErrTime++;</span><br><span class="line">				<span class="keyword">if</span>(ucErrTime&gt;<span class="number">250</span>)</span><br><span class="line">				&#123;</span><br><span class="line">						IIC_Stop();</span><br><span class="line">						<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;<span class="comment">//时钟输出0 	   </span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//产生ACK应答</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Ack</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;</span><br><span class="line">		SDA_OUT();</span><br><span class="line">		IIC_SDA=<span class="number">0</span>;</span><br><span class="line">		delay_us(<span class="number">2</span>);</span><br><span class="line">		IIC_SCL=<span class="number">1</span>;</span><br><span class="line">		delay_us(<span class="number">2</span>);</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//不产生ACK应答		    </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_NAck</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;</span><br><span class="line">		SDA_OUT();</span><br><span class="line">		IIC_SDA=<span class="number">1</span>;</span><br><span class="line">		delay_us(<span class="number">2</span>);</span><br><span class="line">		IIC_SCL=<span class="number">1</span>;</span><br><span class="line">		delay_us(<span class="number">2</span>);</span><br><span class="line">		IIC_SCL=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//IIC发送一个字节</span></span><br><span class="line"><span class="comment">//返回从机有无应答</span></span><br><span class="line"><span class="comment">//1，有应答</span></span><br><span class="line"><span class="comment">//0，无应答			  </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Send_Byte</span><span class="params">(u8 txd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 t;   </span><br><span class="line">		SDA_OUT(); 	    </span><br><span class="line">		IIC_SCL=<span class="number">0</span>;<span class="comment">//拉低时钟开始数据传输</span></span><br><span class="line">		<span class="keyword">for</span>(t=<span class="number">0</span>;t&lt;<span class="number">8</span>;t++)</span><br><span class="line">		&#123;              </span><br><span class="line">				IIC_SDA=(txd&amp;<span class="number">0x80</span>)&gt;&gt;<span class="number">7</span>;</span><br><span class="line">				txd&lt;&lt;=<span class="number">1</span>; 	  </span><br><span class="line">				delay_us(<span class="number">2</span>);   <span class="comment">//对TEA5767这三个延时都是必须的</span></span><br><span class="line">				IIC_SCL=<span class="number">1</span>;</span><br><span class="line">				delay_us(<span class="number">2</span>); </span><br><span class="line">				IIC_SCL=<span class="number">0</span>;	</span><br><span class="line">				delay_us(<span class="number">2</span>);</span><br><span class="line">		&#125;	 </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//读1个字节，ack=1时，发送ACK，ack=0，发送nACK   </span></span><br><span class="line"><span class="function">u8 <span class="title">IIC_Read_Byte</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> ack)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> i,receive=<span class="number">0</span>;</span><br><span class="line">		SDA_IN();<span class="comment">//SDA设置为输入</span></span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++ )</span><br><span class="line">		&#123;</span><br><span class="line">				IIC_SCL=<span class="number">0</span>; </span><br><span class="line">				delay_us(<span class="number">2</span>);</span><br><span class="line">				IIC_SCL=<span class="number">1</span>;</span><br><span class="line">				receive&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(READ_SDA)</span><br><span class="line">						receive++;   </span><br><span class="line">				delay_us(<span class="number">1</span>); </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!ack)</span><br><span class="line">				IIC_NAck();<span class="comment">//发送nACK</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">				IIC_Ack(); <span class="comment">//发送ACK   </span></span><br><span class="line">		<span class="keyword">return</span> receive;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="24CXX-H"><a href="#24CXX-H" class="headerlink" title="24CXX.H"></a>24CXX.H</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __24CXX_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __24CXX_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;iic.h&quot;</span>   </span></span><br><span class="line"><span class="comment">//Mini STM32开发板</span></span><br><span class="line"><span class="comment">//24CXX驱动函数(适合24C01~24C16,24C32~256未经过测试!有待验证!)</span></span><br><span class="line"><span class="comment">//正点原子@ALIENTEK</span></span><br><span class="line"><span class="comment">//2010/6/10</span></span><br><span class="line"><span class="comment">//V1.2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C01		127</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C02		255</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C04		511</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C08		1023</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C16		2047</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C32		4095</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C64	  8191</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C128	16383</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C256	32767  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C512	65535</span></span><br><span class="line"><span class="comment">//Mini STM32开发板使用的是24c02，所以定义EE_TYPE为AT24C02</span></span><br><span class="line"><span class="comment">//#define EE_TYPE AT24C02</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EE_TYPE AT24C512</span></span><br><span class="line">						</span><br><span class="line"><span class="function">u8 <span class="title">AT24CXX_ReadOneByte</span><span class="params">(u16 ReadAddr)</span></span>;							<span class="comment">//指定地址读取一个字节</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteOneByte</span><span class="params">(u16 WriteAddr,u8 DataToWrite)</span></span>;		<span class="comment">//指定地址写入一个字节</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteLenByte</span><span class="params">(u16 WriteAddr,u32 DataToWrite,u8 Len)</span></span>;<span class="comment">//指定地址开始写入指定长度的数据</span></span><br><span class="line"><span class="function">u32 <span class="title">AT24CXX_ReadLenByte</span><span class="params">(u16 ReadAddr,u8 Len)</span></span>;					<span class="comment">//指定地址开始读取指定长度数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Write</span><span class="params">(u16 WriteAddr,u8 *pBuffer,u16 NumToWrite)</span></span>;	<span class="comment">//从指定地址开始写入指定长度的数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Read</span><span class="params">(u16 ReadAddr,u8 *pBuffer,u16 NumToRead)</span></span>;   	<span class="comment">//从指定地址开始读出指定长度的数据</span></span><br><span class="line"> </span><br><span class="line"><span class="function">u8 <span class="title">AT24CXX_Check</span><span class="params">(<span class="keyword">void</span>)</span></span>;  <span class="comment">//检查器件</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Init</span><span class="params">(<span class="keyword">void</span>)</span></span>; <span class="comment">//初始化IIC</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h2 id="24CXX-C"><a href="#24CXX-C" class="headerlink" title="24CXX.C"></a>24CXX.C</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;24cxx.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;delay.h&quot;</span></span></span><br><span class="line"><span class="comment">//Mini STM32开发板</span></span><br><span class="line"><span class="comment">//24CXX驱动函数(适合24C01~24C16,24C32~256未经过测试!有待验证!)</span></span><br><span class="line"><span class="comment">//正点原子@ALIENTEK</span></span><br><span class="line"><span class="comment">//2010/6/10</span></span><br><span class="line"><span class="comment">//V1.2</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//初始化IIC接口</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		IIC_Init();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX指定地址读出一个数据</span></span><br><span class="line"><span class="comment">//ReadAddr:开始读数的地址  </span></span><br><span class="line"><span class="comment">//返回值  :读到的数据</span></span><br><span class="line"><span class="function">u8 <span class="title">AT24CXX_ReadOneByte</span><span class="params">(u16 ReadAddr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 temp=<span class="number">0</span>;		  	    																 </span><br><span class="line">		IIC_Start();  </span><br><span class="line">		<span class="keyword">if</span>(EE_TYPE&gt;AT24C16)</span><br><span class="line">		&#123;</span><br><span class="line">				IIC_Send_Byte(<span class="number">0XA0</span>);	   <span class="comment">//发送写命令</span></span><br><span class="line">				IIC_Wait_Ack();</span><br><span class="line">				IIC_Send_Byte(ReadAddr&gt;&gt;<span class="number">8</span>);<span class="comment">//发送高地址</span></span><br><span class="line">				IIC_Wait_Ack();		 			<span class="comment">//这句也得考虑注释掉</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">				IIC_Send_Byte(<span class="number">0XA0</span>+((ReadAddr/<span class="number">256</span>)&lt;&lt;<span class="number">1</span>));   <span class="comment">//发送器件地址0XA0,写数据 	 </span></span><br><span class="line"> </span><br><span class="line">		<span class="comment">//IIC_Wait_Ack(); 						//这句去掉就OK了，就可以通过AT24CXX_Check()了</span></span><br><span class="line">		IIC_Send_Byte(ReadAddr%<span class="number">256</span>);   <span class="comment">//发送低地址</span></span><br><span class="line">		IIC_Wait_Ack();	    </span><br><span class="line">		IIC_Start();  	 	   </span><br><span class="line">		IIC_Send_Byte(<span class="number">0XA1</span>);           <span class="comment">//进入接收模式			   </span></span><br><span class="line">		IIC_Wait_Ack();	 </span><br><span class="line">		temp=IIC_Read_Byte(<span class="number">0</span>);		   </span><br><span class="line">		IIC_Stop();<span class="comment">//产生一个停止条件	    </span></span><br><span class="line">		<span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX指定地址写入一个数据</span></span><br><span class="line"><span class="comment">//WriteAddr  :写入数据的目的地址    </span></span><br><span class="line"><span class="comment">//DataToWrite:要写入的数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteOneByte</span><span class="params">(u16 WriteAddr,u8 DataToWrite)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		IIC_Start();  </span><br><span class="line">		<span class="keyword">if</span>(EE_TYPE&gt;AT24C16)</span><br><span class="line">		&#123;</span><br><span class="line">				IIC_Send_Byte(<span class="number">0XA0</span>);	    <span class="comment">//发送写命令</span></span><br><span class="line">				IIC_Wait_Ack();</span><br><span class="line">				IIC_Send_Byte(WriteAddr&gt;&gt;<span class="number">8</span>);<span class="comment">//发送高地址</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">				IIC_Send_Byte(<span class="number">0XA0</span>+((WriteAddr/<span class="number">256</span>)&lt;&lt;<span class="number">1</span>));   <span class="comment">//发送器件地址0XA0,写数据 </span></span><br><span class="line">		&#125;	 </span><br><span class="line">		IIC_Wait_Ack();	   </span><br><span class="line">		IIC_Send_Byte(WriteAddr%<span class="number">256</span>);   <span class="comment">//发送低地址</span></span><br><span class="line">		IIC_Wait_Ack(); 	 										  		   </span><br><span class="line">		IIC_Send_Byte(DataToWrite);     <span class="comment">//发送字节							   </span></span><br><span class="line">		IIC_Wait_Ack();  		    	   </span><br><span class="line">		IIC_Stop();<span class="comment">//产生一个停止条件 </span></span><br><span class="line">		delay_ms(<span class="number">10</span>);	 </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX里面的指定地址开始写入长度为Len的数据</span></span><br><span class="line"><span class="comment">//该函数用于写入16bit或者32bit的数据.</span></span><br><span class="line"><span class="comment">//WriteAddr  :开始写入的地址  </span></span><br><span class="line"><span class="comment">//DataToWrite:数据数组首地址</span></span><br><span class="line"><span class="comment">//Len        :要写入数据的长度2,4</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_WriteLenByte</span><span class="params">(u16 WriteAddr,u32 DataToWrite,u8 Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 t;</span><br><span class="line">		<span class="keyword">for</span>(t=<span class="number">0</span>;t&lt;Len;t++)</span><br><span class="line">		&#123;</span><br><span class="line">				AT24CXX_WriteOneByte(WriteAddr+t,(DataToWrite&gt;&gt;(<span class="number">8</span>*t))&amp;<span class="number">0xff</span>);</span><br><span class="line">		&#125;												    </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX里面的指定地址开始读出长度为Len的数据</span></span><br><span class="line"><span class="comment">//该函数用于读出16bit或者32bit的数据.</span></span><br><span class="line"><span class="comment">//ReadAddr   :开始读出的地址 </span></span><br><span class="line"><span class="comment">//返回值     :数据</span></span><br><span class="line"><span class="comment">//Len        :要读出数据的长度2,4</span></span><br><span class="line"><span class="function">u32 <span class="title">AT24CXX_ReadLenByte</span><span class="params">(u16 ReadAddr,u8 Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 t;</span><br><span class="line">		u32 temp=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(t=<span class="number">0</span>;t&lt;Len;t++)</span><br><span class="line">		&#123;</span><br><span class="line">				temp&lt;&lt;=<span class="number">8</span>;</span><br><span class="line">				temp+=AT24CXX_ReadOneByte(ReadAddr+Len-t<span class="number">-1</span>); 	 				   </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> temp;												    </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//检查AT24CXX是否正常</span></span><br><span class="line"><span class="comment">//这里用了24XX的最后一个地址来存储标志字.24C02是255,24C512是65535</span></span><br><span class="line"><span class="comment">//如果用其他24C系列,这个地址要修改</span></span><br><span class="line"><span class="comment">//返回1:检测失败</span></span><br><span class="line"><span class="comment">//返回0:检测成功</span></span><br><span class="line"><span class="function">u8 <span class="title">AT24CXX_Check</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		u8 temp;</span><br><span class="line">		temp=AT24CXX_ReadOneByte(<span class="number">65535</span>);<span class="comment">//避免每次开机都写AT24CXX			   </span></span><br><span class="line">		<span class="keyword">if</span>(temp==<span class="number">0X55</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;		   </span><br><span class="line">		<span class="keyword">else</span><span class="comment">//排除第一次初始化的情况</span></span><br><span class="line">		&#123;</span><br><span class="line">				AT24CXX_WriteOneByte(<span class="number">65535</span>,<span class="number">0X55</span>);</span><br><span class="line">				temp=AT24CXX_ReadOneByte(<span class="number">65535</span>);</span><br><span class="line">				<span class="keyword">if</span>(temp==<span class="number">0X55</span>)</span><br><span class="line">						<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;											  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX里面的指定地址开始读出指定个数的数据</span></span><br><span class="line"><span class="comment">//ReadAddr :开始读出的地址 对24c02为0~255</span></span><br><span class="line"><span class="comment">//pBuffer  :数据数组首地址</span></span><br><span class="line"><span class="comment">//NumToRead:要读出数据的个数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Read</span><span class="params">(u16 ReadAddr,u8 *pBuffer,u16 NumToRead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		<span class="keyword">while</span>(NumToRead)</span><br><span class="line">		&#123;</span><br><span class="line">				*pBuffer++=AT24CXX_ReadOneByte(ReadAddr++);	</span><br><span class="line">				NumToRead--;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//在AT24CXX里面的指定地址开始写入指定个数的数据</span></span><br><span class="line"><span class="comment">//WriteAddr :开始写入的地址 对24c02为0~255</span></span><br><span class="line"><span class="comment">//pBuffer   :数据数组首地址</span></span><br><span class="line"><span class="comment">//NumToWrite:要写入数据的个数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AT24CXX_Write</span><span class="params">(u16 WriteAddr,u8 *pBuffer,u16 NumToWrite)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		<span class="keyword">while</span>(NumToWrite--)</span><br><span class="line">		&#123;</span><br><span class="line">				AT24CXX_WriteOneByte(WriteAddr,*pBuffer);</span><br><span class="line">				WriteAddr++;</span><br><span class="line">				pBuffer++;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">AT24C512的读写问题?- 百度文库  </span></span><br><span class="line"><span class="comment">https://wenku.baidu.com/view/cfc89adaa48da0116c175f0e7cd184254b351bb6.html</span></span><br><span class="line"><span class="comment">阿波罗F4/F7开发板例程不支持24C512的解决办法-OpenEdv-开源电子网  </span></span><br><span class="line"><span class="comment">http://www.openedv.com/forum.php?mod=viewthread&amp;tid=93162&amp;highlight=24C512</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="主程序main-c"><a href="#主程序main-c" class="headerlink" title="主程序main.c"></a>主程序main.c</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;led.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;sys.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;usart.h&quot;</span></span></span><br><span class="line"><span class="comment">//#include &quot;lcd.h&quot;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;key.h&quot;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;24cxx.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;iic.h&quot;</span></span></span><br><span class="line"><span class="comment">//ALIENTEK Mini STM32开发板范例代码19</span></span><br><span class="line"><span class="comment">//IIC实验  </span></span><br><span class="line"><span class="comment">//技术支持：www.openedv.com</span></span><br><span class="line"><span class="comment">//广州市星翼电子科技有限公司</span></span><br><span class="line">   	</span><br><span class="line"><span class="comment">//要写入到24Cxx的字符串数组</span></span><br><span class="line"><span class="keyword">const</span> u8 TEXT_Buffer[]=&#123;<span class="string">&quot;MiniSTM32 IIC TEST&quot;</span>&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE sizeof(TEXT_Buffer)	</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;		<span class="comment">//QQ：1447233384</span></span><br><span class="line">		u8 key;</span><br><span class="line">		u16 i=<span class="number">0</span>;</span><br><span class="line">		u8 datatemp[SIZE];</span><br><span class="line">		NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);<span class="comment">// 设置中断优先级分组2</span></span><br><span class="line">		delay_init();	    	<span class="comment">//延时函数初始化	  </span></span><br><span class="line">		uart_init(<span class="number">9600</span>);	 	<span class="comment">//串口初始化为9600</span></span><br><span class="line">		LED_Init();		  		<span class="comment">//初始化与LED连接的硬件接口</span></span><br><span class="line">		<span class="comment">//LCD_Init();	</span></span><br><span class="line">		KEY_Init();					<span class="comment">//按键初始化		 	</span></span><br><span class="line">		AT24CXX_Init();			<span class="comment">//IIC初始化 </span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;开机成功\r\n&quot;</span>);</span><br><span class="line"> </span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(AT24CXX_Check())<span class="comment">//检测不到24c02</span></span><br><span class="line">		&#123;</span><br><span class="line">				<span class="comment">//LCD_ShowString(60,150,200,16,16,&quot;24C02 Check Failed!&quot;);</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;检测不到\r\n&quot;</span>);</span><br><span class="line">				delay_ms(<span class="number">500</span>);</span><br><span class="line">				<span class="comment">//LCD_ShowString(60,150,200,16,16,&quot;Please Check!      &quot;);</span></span><br><span class="line">				delay_ms(<span class="number">500</span>);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;请检查\r\n&quot;</span>);</span><br><span class="line">				LED0=!LED0;<span class="comment">//DS0闪烁</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;检测存在\r\n&quot;</span>);		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;read \t %d \t.\r\n&quot;</span>, AT24CXX_ReadOneByte(<span class="number">65535</span>)  );</span><br><span class="line">		<span class="comment">//读出AT24CXX_Check()中65535位置中的数值</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">				key=KEY_Scan(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">if</span>(key==WKUP_PRES)<span class="comment">//WK_UP 按下,写入24C02</span></span><br><span class="line">				&#123;</span><br><span class="line">						<span class="comment">//LCD_Fill(0,170,239,319,WHITE);//清除半屏    </span></span><br><span class="line">						<span class="comment">//LCD_ShowString(60,170,200,16,16,&quot;Start Write 24C02....&quot;);</span></span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;Start Write 24C512....\r\n&quot;</span>);</span><br><span class="line">						AT24CXX_Write(<span class="number">0</span>,(u8*)TEXT_Buffer,SIZE);</span><br><span class="line">						<span class="comment">//LCD_ShowString(60,170,200,16,16,&quot;24C02 Write Finished!&quot;);//提示传送完成</span></span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;24C512 Write Finished!\r\n&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(key==KEY0_PRES)<span class="comment">//KEY0 按下,读取字符串并显示</span></span><br><span class="line">				&#123;</span><br><span class="line">						<span class="comment">//LCD_ShowString(60,170,200,16,16,&quot;Start Read 24C02.... &quot;);</span></span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;Start Read 24C512.... \r\n&quot;</span>);</span><br><span class="line">						AT24CXX_Read(<span class="number">0</span>,datatemp,SIZE);</span><br><span class="line">						<span class="comment">//LCD_ShowString(60,170,200,16,16,&quot;The Data Readed Is:  &quot;);//提示传送完成</span></span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;The Data Readed Is:  %s\r\n&quot;</span>,datatemp);</span><br><span class="line">						<span class="comment">//LCD_ShowString(60,190,200,16,16,datatemp);//显示读到的字符串</span></span><br><span class="line">						<span class="comment">//printf(&quot;Start Read 24C02.... \r\n&quot;);</span></span><br><span class="line">				&#125;</span><br><span class="line">				i++;</span><br><span class="line">				delay_ms(<span class="number">10</span>);</span><br><span class="line">				<span class="keyword">if</span>(i==<span class="number">20</span>)</span><br><span class="line">				&#123;</span><br><span class="line">						LED0=!LED0;<span class="comment">//提示系统正在运行	</span></span><br><span class="line">						i=<span class="number">0</span>;</span><br><span class="line">				&#125;		   </span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="AT24Cxx应用介绍"><a href="#AT24Cxx应用介绍" class="headerlink" title="AT24Cxx应用介绍"></a>AT24Cxx应用介绍</h1><p>结论：<br>1、读写AT24CXX芯片，根据容量有多种方式：<br>        一、容量为AT24C01<del>AT24C16，首先发送设备地址（8位地址），再发送数据地址（8位地址），再发送或者接受数据。<br>        二、AT24C32&#x2F;AT24C64</del>AT24C512，首先发送设备地址（8位地址），再发送高位数据地址，再发送地位数据地址，再发送或者接受数据。<br>        三、容量AT24C1024的芯片,是把容量一和容量二的方法结合，设备地址中要用一位作为数据地址位，存储地址长度是17位。<br>2、它的设备地址根据容量不同有区别：<br>        1）、AT24C01<del>AT24C16：这一类又分为两类，分别为AT24C01&#x2F;AT24C02和AT24C04</del>AT24C16;他们的设备地址为高7位，低1位用来作为读写标示位，1为读，0为写。<br>                <strong>1</strong>、AT24C01&#x2F;AT24C02。AT24C01&#x2F;AT24C02的A0、A1、A2引脚作为7位设备地址的低三位，高4为固定为1010B，低三位A0、A1、A2确定了AT24CXX的设备地址，所以一根I2C线上最大可以接8个AT24CXX，地址为1010000B<del>1010111B。<br>                <strong>2</strong>、AT24C04</del>AT24C16的 A0、A1、A2只使用一部分，不用的悬空或者接地（数据手册中写的是悬空不接）。举例：AT24C04只用A2、A1引脚作为设备地址，另外一位A0不用悬空，发送地址中对应的这位（A0）用来写入页寻址的页面号,一根I2C线上最大可以接4个，地址为101000xB~101011xB<br>        2）、AT24C32&#x2F;AT24C64:和AT24C01&#x2F;AT24C02一样，区别是，发送数据地址变成16位。</p>
<p><strong>注意事项：</strong>对AT24C32来说，WP置高，则只有四分之一受保护，即0x0C00－0x0FFF。也就是说保护区为1KBytes。对于低地址的四分之三，则不保护。所以，如果数据较多时，可以有选择地存储。不重要的数据则放在低四分之三区域，重要的数据则放在高四分之一区域。</p>
<p>详细如下：<br>图AT24C01&#x2F;02&#x2F;04&#x2F;08&#x2F;16的外形级封装和引脚说明</p>
<p>AT24C系列为美国ATMEL公司推出的串行COMS型E2PROM，是典型的串行通信E2PROM 。</p>
<p>AT24CXX是IIC总线串行器件,具有工作电源宽(1.8～6.0 V),抗干扰能力强（输入引脚内置施密特触发器滤波抑制噪声),功耗低(写状态时最大工作电流3 mA),高可靠性(写次数100万次,数据保存100年),支持在线编程等特点.</p>
<p>从上面两张图片可以得知：</p>
<p>AT ：ATMEL公司出品</p>
<p>24:  系列号</p>
<p>C ：商业</p>
<p>XX ： 存储容量 ，举例 01 –&gt; 1K à 128 字节</p>
<pre><code>02 à 2K à 256 字节
</code></pre>
<p>   …………….</p>
<pre><code>16à 16K à 2K 字节
</code></pre>
<p>I2C总线协议规定，任何将数据传送到总线的器件作为发送器。任何从总线接收数据的器件为接收器。</p>
<p>主器件控制串行时钟和起始、停止信号的发生。主器件任何期间都可以发送或接收数据，但是主器件控制数据传送模式（发送或者接收）。</p>
<p>WP写保护引脚：当该引脚连接到VCC，I2C器件内的内容被写保护（只能读）。如果允许对器件进行正常的读写，那么WP引脚需连接到地或者悬空。</p>
<p>通过器件地址输入端A0、A1、A2可以实现讲最多8个at24c01器件和at24c02器件、4个at24c04器件、2个at24c08器件、1个at24c16器件连接到总线上。当总线上只有一个器件时，A0、A1、A2可以连接到地或者悬空。</p>
<p>下面重点分析一下这句话：为什么 at24c01&#x2F;at24c02 可以挂接8个器件呢？为什么到了 at24C16 却只能挂接1个器件呢？？？</p>
<p>WHY？ </p>
<p>器件识别控制字节的作用</p>
<p>以at24c01&#x2F;at24c02 和at24C16  举例：</p>
<p>I2C总线上所有外围器件都有唯一的地址，这个地址由器件地址和引脚地址两部分组成。共7位。</p>
<p>器件地址是I2C器件固有的地址编码，器件出厂时已经给定，不可更改。</p>
<p>引脚地址由I2C总线外围器件的地址引脚A0、A1、A2决定，根据其在电路中接电源正极、接地或者悬空的不同，形成不同的地址代码。引脚地址数也决定了同一器件可接入总线的最大数目。</p>
<p>此时于引脚地址无关，与 P2、P1、P0有关，即页地址有关，页地址高三位是器件识别控制字节的1－3位，器件上的A0，A1，A2，就无效了，所以只能接1个AT24C16器件。</p>
<p>页地址是什么乖乖，从何而来呢？？？？</p>
<p>上图可知 AT24C16 存储容量 16K &#x3D; 2K字节 &#x3D; 128（页面数）* 16 （每页的字节数） &#x3D; 2^11 (寻址地址位数 11位)。</p>
<p>AT24C16内部有2048*8位的存储容量，即可以存储2K字节的数据。这2K字节被放在128个页内，每页存放16个字节。所以对AT24C16内部的访问需要11位地址（0-7ff）。</p>
<p>举个实际的例子：</p>
<p>对AT24C16访问时，按照页地址和页偏移量的方式进行访问。</p>
<p>比如要访问第100页的第3个字节，则在发送寻址的时候，就要发送0X0643,其中页地址的高三位放在器件地址中。</p>
<p>第100页的第3个字节  &#x3D;&#x3D;  0X0643</p>
<p>0643 &#x3D; 6 * 256 + 4 * 16  + 3 &#x3D;  （6<em>16+4）</em>16 + 3 &#x3D; 1603 </p>
<p>就是 100页的第3个字节。</p>
<p>所以在编写程序对AT24C16第100页的第3个字节进行写数据的时候，步骤如下：</p>
<p>1）发送起始信号；</p>
<p>2）发送器件地址0XAC（1010 1100，1010是固定地址，110是页地址的高三位，0表示写操作）；</p>
<p>3）发送操作地址0X43（0100 0010，0100是页地址的低四位，0010是页地址偏移量，即第100页内的第三个字节；</p>
<p>4）发送要写的数据；</p>
<p>5）发送终止信号。</p>
<h1 id="STM32-AT24CXX器件地址的理解（IIC通讯协议）"><a href="#STM32-AT24CXX器件地址的理解（IIC通讯协议）" class="headerlink" title="STM32 AT24CXX器件地址的理解（IIC通讯协议）"></a>STM32 AT24CXX器件地址的理解（IIC通讯协议）</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (EE_TYPE &gt; AT24C16)      <span class="comment">/* 24C16以上的型号, 分2个字节发送地址 */</span></span><br><span class="line">    &#123;</span><br><span class="line">        iic_send_byte(<span class="number">0XA0</span>);    <span class="comment">/* 发送写命令, IIC规定最低位是0, 表示写入 */</span></span><br><span class="line">        iic_wait_ack();         <span class="comment">/* 每次发送完一个字节,都要等待ACK */</span></span><br><span class="line">        iic_send_byte(addr &gt;&gt; <span class="number">8</span>);<span class="comment">/* 发送高字节地址 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        iic_send_byte(<span class="number">0XA0</span> + ((addr &gt;&gt; <span class="number">8</span>) &lt;&lt; <span class="number">1</span>));   <span class="comment">/* 发送器件 0XA0 + 高位a8/a9/a10地址,写数据 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    iic_wait_ack();             <span class="comment">/* 每次发送完一个字节,都要等待ACK */</span></span><br><span class="line">    iic_send_byte(addr % <span class="number">256</span>);  <span class="comment">/* 发送低位地址 */</span></span><br><span class="line">    iic_wait_ack();             <span class="comment">/* 等待ACK, 此时地址发送完成了 */</span></span><br></pre></td></tr></table></figure>

<p>EETYPE为宏定义，具体如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C01     127</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C02     255</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C04     511</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C08     1023</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C16     2047</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C32     4095</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C64     8191</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C128    16383</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AT24C256    32767</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 开发板使用的是24c02，所以定义EE_TYPE为AT24C02 */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EE_TYPE     AT24C02</span></span><br></pre></td></tr></table></figure>

<p>根据尼使用得AT24C型号得不同，给EE_TYPE初始化不同的值。先讨论C16以下的</p>
<pre><code> *    对于24C01/02, 其器件地址格式(8bit)为: 1  0  1  0  A2  A1  A0  R/W
 *    对于24C04,    其器件地址格式(8bit)为: 1  0  1  0  A2  A1  a8  R/W
 *    对于24C08,    其器件地址格式(8bit)为: 1  0  1  0  A2  a9  a8  R/W
 *    对于24C16,    其器件地址格式(8bit)为: 1  0  1  0  a10 a9  a8  R/W
</code></pre>
<p><strong>R&#x2F;W:</strong> 读&#x2F;写控制位 0,表示写; 1,表示读;<br><strong>A0&#x2F;A1&#x2F;A2:</strong> 对应器件的1,2,3引脚(只有24C01&#x2F;02&#x2F;04&#x2F;8有这些脚，16以上的芯片没设计这些脚)<br><strong>a8&#x2F;a9&#x2F;a10:</strong> 对应存储地址的高位。</p>
<p>比如24C04 有512byte（32page16byte),地址本质都是0 1这种二进制（经常我们看到的地址表示形式是0x00000008这种，是32位机下，四个二进制转换成一个十六进制形成的），一位二进制（2的一次方）能代表两个地址块，2位二进制（2的平方）能代表四个地址块，512个地址块就需要2的九次方，所以每个地址需要9位来表示来能把这521byte覆盖完。在发送时，只能一个字节一个字节的发送，你要一口气发九个字节，从机会领悟不到的，所以可以先把高位的1位弄成00000001发送，再发最后的八位，加上1  0  1  0  A2  A1  A0  R&#x2F;W，一共要发三次才能确定要读或者写的地址，麻烦！！</p>
<p>所以我们把多出来的1位（第九位，这个最高位）放到1  0  1  0  A2  A1  A0  R&#x2F;W的A0位去传输，这样只用传输两次即可。如果多了两位就把多的放在A1,和A0位去传输。</p>
<hr>
<p>以上方法最多11bit地址，最多可以表示2048个位置,可以寻址24C16及以内的型号</p>
<p>针对C32以后的，不够用了，所以干脆就大大方方的先发1  0  1  0  A2  A1  A0  R&#x2F;W，再分两次发送地址</p>
<hr>
<p>iic_send_byte(0XA0 + ((addr &gt;&gt; 8) &lt;&lt; 1));</p>
<p>这句代码的理解：addr &gt;&gt; 8左移八位，把八位之后的东西留下来再左移一位后与0XA0相加，左移这一位相当于是给R&#x2F;W腾了个位置，通过这句代码，把地址的高x位取出来了，然后随着1  0  1  0  A2  A1  A0  R&#x2F;W发送出去。</p>
<hr>
<h1 id="相关链接（侵删）"><a href="#相关链接（侵删）" class="headerlink" title="相关链接（侵删）"></a>相关链接（侵删）</h1><ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wanglong3713/article/details/124909042">AT24C32、AT24C64、AT24C128、AT24C256、AT24C512系列EEPROM芯片单片机读写驱动程序</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44836335/article/details/134663326">串行 EEPROM 存储器芯片AT24C32（兼容同系列AT24CXX）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ba_wang_mao/article/details/108142765">AT24CXX系列芯片在STM32F103单片机下的读写程序</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/leo0621/p/8251897.html">EEPROM—AT24Cxx应用介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42747105/article/details/130833208">STM32 AT24CXX器件地址的理解（IIC通讯协议）</a></li>
</ol>
<hr>
<center><font color=red>=================我是分割线=================</font></center>


<p><strong>欢迎到公众号来唠嗑:</strong></p>
<img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://zml3589110.github.io">ZhaoYichen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zml3589110.github.io/posts/887274336.html">https://zml3589110.github.io/posts/887274336.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zml3589110.github.io" target="_blank">赵逸尘个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87/">存储芯片</a><a class="post-meta__tags" href="/tags/EEPROM/">EEPROM</a><a class="post-meta__tags" href="/tags/AT24CXX/">AT24CXX</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2102930043.html"><img class="prev-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">C#数据结构之二（队列的使用）</div></div></a></div><div class="next-post pull-right"><a href="/posts/1577525161.html"><img class="next-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">C#控件DataGridView之六（常用功能）</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ZhaoYichen</div><div class="author-info__description">直到这一刻微笑着说话为止，我至少留下了一公升眼泪</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">344</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">490</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">194</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zml3589110"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zml3589110" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zhaominglong_life@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">1.</span> <span class="toc-text">注意说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%9F"><span class="toc-number">2.</span> <span class="toc-text">一、应用场景？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81AT24C32%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">二、AT24C32是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%AF%E7%89%87%E5%AF%B9%E6%AF%94"><span class="toc-number">3.1.</span> <span class="toc-text">芯片对比</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.</span> <span class="toc-text">三、使用步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BC%95%E8%84%9A%E8%AF%B4%E6%98%8E"><span class="toc-number">4.1.</span> <span class="toc-text">1.引脚说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">1.2读写操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-%E5%86%99%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.1.</span> <span class="toc-text">1.2.1 写操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E5%86%99%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.2.</span> <span class="toc-text">1.2.2 写操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-%E5%8F%AF%E5%8F%82%E8%80%83"><span class="toc-number">4.2.3.</span> <span class="toc-text">1.2.3 示例代码(可参考)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">4.3.</span> <span class="toc-text">2.示例代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%AF%BB%E5%8F%96%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89%EF%BC%9A"><span class="toc-number">4.3.1.</span> <span class="toc-text">2.1 读取一个字节数据代码如下（示例）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%86%99%E5%85%A5%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89%EF%BC%9A"><span class="toc-number">4.3.2.</span> <span class="toc-text">2.2 写入一个字节数据代码如下（示例）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%AF%BB%E5%8F%96%E8%8B%A5%E5%B9%B2%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89%EF%BC%9A"><span class="toc-number">4.3.3.</span> <span class="toc-text">2.3 读取若干数据代码如下（示例）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%86%99%E5%85%A5%E8%8B%A5%E5%B9%B2%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89%EF%BC%9A"><span class="toc-number">4.3.4.</span> <span class="toc-text">2.4 写入若干数据代码如下（示例）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89%EF%BC%9A"><span class="toc-number">4.3.5.</span> <span class="toc-text">2.5 测试代码如下（示例）：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="toc-number">4.4.</span> <span class="toc-text">3.测试结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E4%B8%80"><span class="toc-number">5.</span> <span class="toc-text">其他示例代码一</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#IIC-H"><span class="toc-number">5.1.</span> <span class="toc-text">IIC.H</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IIC-C"><span class="toc-number">5.2.</span> <span class="toc-text">IIC.C</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24CXX-H"><span class="toc-number">5.3.</span> <span class="toc-text">24CXX.H</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24CXX-C"><span class="toc-number">5.4.</span> <span class="toc-text">24CXX.C</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E7%A8%8B%E5%BA%8Fmain-c"><span class="toc-number">5.5.</span> <span class="toc-text">主程序main.c</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AT24Cxx%E5%BA%94%E7%94%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">6.</span> <span class="toc-text">AT24Cxx应用介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#STM32-AT24CXX%E5%99%A8%E4%BB%B6%E5%9C%B0%E5%9D%80%E7%9A%84%E7%90%86%E8%A7%A3%EF%BC%88IIC%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">STM32 AT24CXX器件地址的理解（IIC通讯协议）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5%EF%BC%88%E4%BE%B5%E5%88%A0%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">相关链接（侵删）</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1282388373.html" title="STM32实现动态加载APP"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="STM32实现动态加载APP"/></a><div class="content"><a class="title" href="/posts/1282388373.html" title="STM32实现动态加载APP">STM32实现动态加载APP</a><time datetime="2025-06-24T08:07:20.000Z" title="发表于 2025-06-24 16:07:20">2025-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2632262355.html" title="基于MQTT微信小程序"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于MQTT微信小程序"/></a><div class="content"><a class="title" href="/posts/2632262355.html" title="基于MQTT微信小程序">基于MQTT微信小程序</a><time datetime="2025-06-18T06:32:20.000Z" title="发表于 2025-06-18 14:32:20">2025-06-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/208779946.html" title="WouoUI-PageVersion基础使用"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WouoUI-PageVersion基础使用"/></a><div class="content"><a class="title" href="/posts/208779946.html" title="WouoUI-PageVersion基础使用">WouoUI-PageVersion基础使用</a><time datetime="2025-06-18T02:23:20.000Z" title="发表于 2025-06-18 10:23:20">2025-06-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/569701768.html" title="ESP8266内存分配"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ESP8266内存分配"/></a><div class="content"><a class="title" href="/posts/569701768.html" title="ESP8266内存分配">ESP8266内存分配</a><time datetime="2025-06-16T12:09:20.000Z" title="发表于 2025-06-16 20:09:20">2025-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4236902251.html" title="ESP8266使用Mongoose-os初体验"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ESP8266使用Mongoose-os初体验"/></a><div class="content"><a class="title" href="/posts/4236902251.html" title="ESP8266使用Mongoose-os初体验">ESP8266使用Mongoose-os初体验</a><time datetime="2025-06-12T12:52:20.000Z" title="发表于 2025-06-12 20:52:20">2025-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By ZhaoYichen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="icp连接"><img class="icp-icon" src="icp图片"><span>备案号：xxxxxx</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>